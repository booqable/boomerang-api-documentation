# Lines

Lines make up the individual elements of an order, document, or cart.
They contain information about pricing, planning, or markup.

Lines can only be created for orders. On invoices, lines are automatically generated
based on price changes of the order. For quotes and contracts, lines are generated through
the [Document](#documents) resource.

## Kinds of Lines

1. **Planning lines** Lines that have an associated Planning. These lines cannot be created through
   the Line resource but are created by submitting a `book_*` action to [OrderFulfillments](#order-fulfillments).
   Updating or destroying a line linked to a planning will also destroy the planning.

2. **Custom lines** Lines created through the resource that don't have a planning associated with them.
   Can be of one of type `charge` or `section`.

### Types of Lines

- `charge` Regular charge line which contains price information.
  These lines are automatically generated for each Planning, but they can also
  be added manually for one-off charges.
- `section` Behaves as a visual section on orders and documents.
  Sections allow users to organize orders as they like and do not affect order totals.
- `deposit_charge` A deposit charge line generated by a deposit hold action.
  This line is always calculated from a price including taxes.
- `proration` A line representing a proration. These lines only appear on invoices
  and can't be updated or destroyed by the resource; they are automatically synced.
- `refund` This line was created due to a refund.
- `delivery_rate` This line represents delivery charges based on carrier rates.
  These are created for delivery orders.
- `legacy_migration` Proration bundled as one line. These lines appear on
  invoices that were made before Booqable was able to sync invoices automatically.
- `delivery_rate` When order `fulfillment_type` is `delivery`, this line is created to
  represent the delivery rate information (price, label, etc).

## Line Price Calculation

Line prices are calculated based on several factors:

- For planning lines, the price is based on the item's price settings, the rental period,
  and any applicable price rules.
- The `charge_length` (in seconds) can differ from the actual rental period due to
  price rule adjustments.
- The `price_rule_values` attribute contains a detailed breakdown of how price rules
  affected the final price.
- Setting `charge_length` to `null` will trigger recalculation based on order period and rules.
- For custom charge lines, the price is manually set and not affected by period changes.

## Ownership Model

Lines have an `owner` polymorphic relationship which can point to either:
- An Order (for order lines)
- A Document (for invoice, quote, and contract lines)

Lines also have a direct `order_id` which always points to the related order, even when
the line is owned by a document. This makes it easier to retrieve the order context.

### Bundles

Nested lines contain information about individual items in a Bundle; for these lines,
the quantity and price information cannot be updated directly but should be updated
through the parent line instead.

### Sorting Lines

```
# example of lines when using bundles
(position=1) Product A
(position=2) Product B
(position=3) Bundle
  (position=1) Product C
  (position=2) Product D
```

When using Bundles, the `line.position` attribute is not unique. Special care needs
to be taken to sort all lines correctly.

When booking a bundle:

- The parent line is assigned a `position` based on the other lines already on the order.
- The child lines are assigned a `position` based on how the bundle is configured.

To correctly sort all lines so they appear as they do within Booqable:

- Child lines should be sorted relative to their siblings of the same parent.
  To do this, child lines need to be grouped by the `parent_line_id` attribute.

## Relationships
Name | Description
-- | --
`item` | **[Item](#items)** `optional`<br>The Product or Bundle that was booked, when this Line has an associated Planning. 
`nested_lines` | **[Lines](#lines)** `hasmany`<br>When `item` is a Bundle, then there is a nested line that corresponds for each BundleItem. 
`order` | **[Order](#orders)** `required`<br>The [Order](#orders) this Line belongs to. 
`owner` | **[Order](#orders), [Document](#documents)** `required`<br>The resource this Line belongs to. Either the [Order](#orders) directly, or a [Document](#documents). 
`parent_line` | **[Line](#lines)** `optional`<br>When present, this Line is part of a Bundle and corresponds to a BundleItem. Inverse of the `nested_lines` relation. 
`planning` | **[Planning](#plannings)** `optional`<br>The [Planning](#plannings) for which this Line was created that contains the logistical information related to this Line. 
`price_structure` | **[Price structure](#price-structures)** `optional`<br>The [PriceStructure](#price-structures) used to calculate the price. 
`price_tile` | **[Price tile](#price-tiles)** `optional`<br>The [PriceTile](#price-tiles) that was selected to calculate the price. 
`tax_category` | **[Tax category](#tax-categories)** `optional`<br>[TaxCategory](#tax-categories) applied to this Line. 


Check matching attributes under [Fields](#lines-fields) to see which relations can be written.
<br/ >
Check each individual operation to see which relations can be included as a sideload.
## Fields

 Name | Description
-- | --
`archived` | **boolean** `readonly`<br>Whether line is archived. 
`archived_at` | **datetime** `readonly` `nullable`<br>When the line was archived. 
`charge_label` | **string** `nullable`<br>Charge label. 
`charge_length` | **integer** `nullable`<br>The charge length in seconds. It can be different than the time planned. Setting `charge_length` to `null` will trigger recalculation of the price based on order period and price rules. <br/> To recalculate prices for the entire order, use [OrderPriceRecalculation](#order-price-recalculations). 
`confirm_shortage` | **boolean** `writeonly`<br>Whether to confirm a shortage when updating quantity on a line. When a line has an associated planning and you increase the quantity, the planning's quantity will also be increased. If this results in a shortage (requested quantity exceeds available inventory), the update will fail with a shortage error.<br>Setting this to `true` confirms that you want to proceed with the update despite the shortage. This is useful when you know you'll be able to fulfill the order through other means, such as acquiring additional inventory before the rental period.<br>Overriding shortage warnings is only possible when the ProductGroup is configured to allow shortage. 
`created_at` | **datetime** `readonly`<br>When the resource was created.
`discountable` | **boolean** <br>Whether line is discountable. 
`extra_information` | **string** `nullable`<br>Extra information about the line. 
`id` | **uuid** `readonly`<br>Primary key.
`item_id` | **uuid** `readonly` `nullable`<br>The Product or Bundle that was booked, when this Line has an associated Planning. 
`line_type` | **enum** `readonly-after-create`<br>Type of line. Can be one of: - `charge`: Regular charge line for rental items or custom charges - `section`: Visual section for organizing lines (no financial impact) - `deposit_charge`: Deposit charge line - `proration`: Partial charge for partial rental periods (invoices only) - `refund`: Refund line with negative amount - `delivery_rate`: Delivery charge based on carrier rates - `legacy_migration`: Legacy proration line<br>Only `charge` and `section` line types can be created through the resource. Other types are created by the system.<br> One of: `section`, `deposit_charge`, `proration`, `charge`, `legacy_migration`, `delivery_rate`.
`order_id` | **uuid** `readonly`<br>The [Order](#orders) this Line belongs to. 
`original_charge_label` | **string** `nullable`<br>The original charge label of the product (without price rule adjustments). 
`original_charge_length` | **integer** `readonly`<br>The original charge length of the product (without price rule adjustments). 
`original_price_each_in_cents` | **integer** `readonly`<br>The original price of the product (without price rule adjustments). 
`owner_id` | **uuid** `readonly-after-create`<br>The resource this Line belongs to. Either the [Order](#orders) directly, or a [Document](#documents). 
`owner_type` | **enum** `readonly-after-create`<br>The resource type of the owner.<br>One of: `orders`, `documents`.
`parent_line_id` | **uuid** `readonly` `nullable`<br>When present, this Line is part of a Bundle and corresponds to a BundleItem. Inverse of the `nested_lines` relation. 
`planning_id` | **uuid** `readonly` `nullable`<br>The [Planning](#plannings) for which this Line was created that contains the logistical information related to this Line. 
`position` | **integer** `nullable`<br>The ordering of lines on an order or document. See [this section](#lines-fetching-an-item-sorting-lines) to understand how to sort when using bundles. 
`price_each_in_cents` | **integer** <br>Price of each line. 
`price_in_cents` | **integer** `readonly`<br>Price of each line x quantity, based on the tax setting of the company (inclusive vs. exclusive). 
`price_rule_values` | **hash** `readonly` `nullable`<br>Breakdown of applied price rules. This is a complex structure that contains detailed information about how price rules affected the final price calculation, including: - Which price rules were applied - What time periods they applied to - How they affected the pricing - The resulting price adjustments<br>This data is particularly useful for understanding why a line has its current price and for providing transparent pricing explanations to customers. 
`price_structure_id` | **uuid** `readonly` `nullable`<br>The [PriceStructure](#price-structures) used to calculate the price. 
`price_tile_id` | **uuid** `nullable`<br>The [PriceTile](#price-tiles) that was selected to calculate the price. 
`quantity` | **integer** <br>The quantity to calculate with. When updating quantity of a line with an associated planning, the planning also gets updated, which may lead to a shortage error. 
`relevant` | **boolean** `readonly`<br>When `false` this line should not be shown to users. It is only needed for calculation of prorations. 
`tax_category_id` | **uuid** `nullable`<br>[TaxCategory](#tax-categories) applied to this Line. 
`taxable` | **boolean** <br>Whether line is taxable. 
`title` | **string** `nullable`<br>Title of the line. 
`updated_at` | **datetime** `readonly`<br>When the resource was last updated.


## List lines


> How to fetch a list of lines:

```shell
  curl --get 'https://example.booqable.com/api/4/lines'
       --header 'content-type: application/json'
```

> A 200 status response looks like this:

```json
  {
    "data": [
      {
        "id": "ae4a88a4-9a7a-4caf-811c-27f85ebe167f",
        "type": "lines",
        "attributes": {
          "created_at": "2023-08-08T15:06:00.000000+00:00",
          "updated_at": "2023-08-08T15:06:00.000000+00:00",
          "archived": false,
          "archived_at": null,
          "title": "Macbook Pro",
          "extra_information": "Comes with a mouse",
          "quantity": 1,
          "original_price_each_in_cents": 72500,
          "original_charge_length": null,
          "original_charge_label": null,
          "price_each_in_cents": 80250,
          "price_in_cents": 80250,
          "position": 1,
          "charge_label": "29 days",
          "charge_length": 2505600,
          "price_rule_values": {
            "charge": {
              "from": "1977-11-16T23:49:00.000000+00:00",
              "till": "1977-12-15T23:49:00.000000+00:00",
              "adjustments": [
                {
                  "name": "Pickup day"
                },
                {
                  "name": "Return day"
                }
              ]
            },
            "price": [
              {
                "name": "High-Season",
                "charge_length": 1339200,
                "multiplier": "0.2",
                "price_in_cents": 7750,
                "adjustments": [
                  {
                    "from": "1977-11-30T11:49:00.000000+00:00",
                    "till": "1977-12-15T23:49:00.000000+00:00",
                    "charge_length": 1339200,
                    "charge_label": "372 hours",
                    "price_in_cents": 7750
                  }
                ],
                "stacked": false
              }
            ]
          },
          "discountable": true,
          "taxable": true,
          "line_type": "charge",
          "relevant": true,
          "order_id": "db61e960-dc39-40c0-8967-af01657ec0d0",
          "item_id": "dfb7e7c5-6c92-44de-8fd3-beb9fe5dee6e",
          "tax_category_id": "4c97f8cd-9bbf-4048-819a-f50d8b7bff7b",
          "price_structure_id": null,
          "price_tile_id": null,
          "planning_id": "9cf6e39a-f13f-46c3-89db-f1fd269f1bfd",
          "parent_line_id": null,
          "owner_id": "db61e960-dc39-40c0-8967-af01657ec0d0",
          "owner_type": "orders"
        },
        "relationships": {}
      }
    ],
    "meta": {}
  }
```

### HTTP Request

`GET /api/4/lines`

### Request params

This request accepts the following parameters:

Name | Description
-- | --
`fields[]` | **array** <br>List of comma separated fields to include instead of the default fields. `?fields[lines]=created_at,updated_at,archived`
`filter` | **hash** <br>The filters to apply `?filter[attribute][eq]=value`
`include` | **string** <br>List of comma seperated relationships to sideload. `?include=order,owner,tax_category`
`meta` | **hash** <br>Metadata to send along. `?meta[total][]=count`
`page[number]` | **string** <br>The page to request.
`page[size]` | **string** <br>The amount of items per page.
`sort` | **string** <br>How to sort the data. `?sort=attribute1,-attribute2`


### Filters

This request can be filtered on:

Name | Description
-- | --
`archived` | **boolean** <br>`eq`
`archived_at` | **datetime** <br>`eq`, `not_eq`, `gt`, `gte`, `lt`, `lte`
`created_at` | **datetime** <br>`eq`, `not_eq`, `gt`, `gte`, `lt`, `lte`
`discountable` | **boolean** <br>`eq`
`id` | **uuid** <br>`eq`, `not_eq`
`item_id` | **uuid** <br>`eq`, `not_eq`
`line_type` | **enum** <br>`eq`
`order_id` | **uuid** <br>`eq`
`owner_id` | **uuid** <br>`eq`, `not_eq`
`owner_type` | **enum** <br>`eq`, `not_eq`
`parent_line_id` | **uuid** <br>`eq`, `not_eq`
`planning_id` | **uuid** <br>`eq`, `not_eq`
`price_structure_id` | **uuid** <br>`eq`, `not_eq`
`price_tile_id` | **uuid** <br>`eq`, `not_eq`
`quantity` | **integer** <br>`eq`, `not_eq`, `gt`, `gte`, `lt`, `lte`
`relevant` | **boolean** <br>`eq`
`tax_category_id` | **uuid** <br>`eq`, `not_eq`
`taxable` | **boolean** <br>`eq`
`title` | **string** <br>`eq`, `not_eq`, `eql`, `not_eql`, `prefix`, `not_prefix`, `suffix`, `not_suffix`, `match`, `not_match`
`updated_at` | **datetime** <br>`eq`, `not_eq`, `gt`, `gte`, `lt`, `lte`


### Meta

Results can be aggregated on:

Name | Description
-- | --
`total` | **array** <br>`count`


### Includes

This request accepts the following includes:

<ul>
  <li><code>order</code></li>
  <li><code>owner</code></li>
  <li>
    <code>planning</code>
    <ul>
      <li>
          <code>item</code>
          <ul>
            <li><code>photo</code></li>
          </ul>
      </li>
    </ul>
  </li>
  <li><code>tax_category</code></li>
</ul>


## Fetch a line


> How to fetch a line:

```shell
  curl --get 'https://example.booqable.com/api/4/lines/b4c827b6-c766-42d8-831c-87f9a610b8fa'
       --header 'content-type: application/json'
```

> A 200 status response looks like this:

```json
  {
    "data": {
      "id": "b4c827b6-c766-42d8-831c-87f9a610b8fa",
      "type": "lines",
      "attributes": {
        "created_at": "2022-10-10T21:41:02.000000+00:00",
        "updated_at": "2022-10-10T21:41:02.000000+00:00",
        "archived": false,
        "archived_at": null,
        "title": "Macbook Pro",
        "extra_information": "Comes with a mouse",
        "quantity": 1,
        "original_price_each_in_cents": 72500,
        "original_charge_length": null,
        "original_charge_label": null,
        "price_each_in_cents": 80250,
        "price_in_cents": 80250,
        "position": 1,
        "charge_label": "29 days",
        "charge_length": 2505600,
        "price_rule_values": {
          "charge": {
            "from": "1977-01-19T06:24:02.000000+00:00",
            "till": "1977-02-17T06:24:02.000000+00:00",
            "adjustments": [
              {
                "name": "Pickup day"
              },
              {
                "name": "Return day"
              }
            ]
          },
          "price": [
            {
              "name": "High-Season",
              "charge_length": 1339200,
              "multiplier": "0.2",
              "price_in_cents": 7750,
              "adjustments": [
                {
                  "from": "1977-02-01T18:24:02.000000+00:00",
                  "till": "1977-02-17T06:24:02.000000+00:00",
                  "charge_length": 1339200,
                  "charge_label": "372 hours",
                  "price_in_cents": 7750
                }
              ],
              "stacked": false
            }
          ]
        },
        "discountable": true,
        "taxable": true,
        "line_type": "charge",
        "relevant": true,
        "order_id": "a206e703-8fe7-4045-826a-36b938ea47d4",
        "item_id": "d4996c4d-efe0-4972-8124-37812a882d50",
        "tax_category_id": "28930517-53d0-4346-865d-0988b23e5ea6",
        "price_structure_id": null,
        "price_tile_id": null,
        "planning_id": "01296b4b-a633-4808-8993-91a287f01c9b",
        "parent_line_id": null,
        "owner_id": "a206e703-8fe7-4045-826a-36b938ea47d4",
        "owner_type": "orders"
      },
      "relationships": {}
    },
    "meta": {}
  }
```

### HTTP Request

`GET /api/4/lines/{id}`

### Request params

This request accepts the following parameters:

Name | Description
-- | --
`fields[]` | **array** <br>List of comma separated fields to include instead of the default fields. `?fields[lines]=created_at,updated_at,archived`
`include` | **string** <br>List of comma seperated relationships to sideload. `?include=order,owner,tax_category`


### Includes

This request accepts the following includes:

<ul>
  <li>
    <code>nested_lines</code>
    <ul>
      <li><code>planning</code></li>
    </ul>
  </li>
  <li>
    <code>order</code>
    <ul>
      <li><code>tax_values</code></li>
    </ul>
  </li>
  <li>
    <code>owner</code>
    <ul>
      <li><code>tax_values</code></li>
    </ul>
  </li>
  <li><code>parent_line</code></li>
  <li>
    <code>planning</code>
    <ul>
      <li>
          <code>item</code>
          <ul>
            <li><code>photo</code></li>
          </ul>
      </li>
    </ul>
  </li>
  <li><code>tax_category</code></li>
</ul>


## Create a line

Lines created through this endpoint, so-called custom lines, can only have the type `charge` or `section`.
Custom `charge` lines enable you to add charges not (directly) connected to a product to an order.
Sections allow to add some organization to orders.

Order totals are automatically re-calculated after the creation of a new line and an invoice sync will be triggered if changes are relevant.

> How to create a line:

```shell
  curl --request POST
       --url 'https://example.booqable.com/api/4/lines'
       --header 'content-type: application/json'
       --data '{
         "data": {
           "type": "lines",
           "attributes": {
             "owner_id": "e429675c-a2e8-46c3-88f4-316a4bdd2e5d",
             "owner_type": "orders",
             "price_each_in_cents": 1000
           }
         }
       }'
```

> A 201 status response looks like this:

```json
  {
    "data": {
      "id": "69903b58-4d14-4bcb-8490-66c5df3ee4df",
      "type": "lines",
      "attributes": {
        "created_at": "2017-01-15T11:15:00.000000+00:00",
        "updated_at": "2017-01-15T11:15:00.000000+00:00",
        "archived": false,
        "archived_at": null,
        "title": null,
        "extra_information": null,
        "quantity": 1,
        "original_price_each_in_cents": null,
        "original_charge_length": null,
        "original_charge_label": null,
        "price_each_in_cents": 1000,
        "price_in_cents": 1000,
        "position": 1,
        "charge_label": null,
        "charge_length": null,
        "price_rule_values": null,
        "discountable": true,
        "taxable": true,
        "line_type": "charge",
        "relevant": true,
        "order_id": "e429675c-a2e8-46c3-88f4-316a4bdd2e5d",
        "item_id": null,
        "tax_category_id": null,
        "price_structure_id": null,
        "price_tile_id": null,
        "planning_id": null,
        "parent_line_id": null,
        "owner_id": "e429675c-a2e8-46c3-88f4-316a4bdd2e5d",
        "owner_type": "orders"
      },
      "relationships": {}
    },
    "meta": {}
  }
```

### HTTP Request

`POST /api/4/lines`

### Request params

This request accepts the following parameters:

Name | Description
-- | --
`fields[]` | **array** <br>List of comma separated fields to include instead of the default fields. `?fields[lines]=created_at,updated_at,archived`
`include` | **string** <br>List of comma seperated relationships to sideload. `?include=order,owner,tax_category`


### Request body

This request accepts the following body:

Name | Description
-- | --
`data[attributes][charge_label]` | **string** <br>Charge label. 
`data[attributes][charge_length]` | **integer** <br>The charge length in seconds. It can be different than the time planned. Setting `charge_length` to `null` will trigger recalculation of the price based on order period and price rules. <br/> To recalculate prices for the entire order, use [OrderPriceRecalculation](#order-price-recalculations). 
`data[attributes][confirm_shortage]` | **boolean** <br>Whether to confirm a shortage when updating quantity on a line. When a line has an associated planning and you increase the quantity, the planning's quantity will also be increased. If this results in a shortage (requested quantity exceeds available inventory), the update will fail with a shortage error.<br>Setting this to `true` confirms that you want to proceed with the update despite the shortage. This is useful when you know you'll be able to fulfill the order through other means, such as acquiring additional inventory before the rental period.<br>Overriding shortage warnings is only possible when the ProductGroup is configured to allow shortage. 
`data[attributes][discountable]` | **boolean** <br>Whether line is discountable. 
`data[attributes][extra_information]` | **string** <br>Extra information about the line. 
`data[attributes][line_type]` | **enum** <br>Type of line. Can be one of: - `charge`: Regular charge line for rental items or custom charges - `section`: Visual section for organizing lines (no financial impact) - `deposit_charge`: Deposit charge line - `proration`: Partial charge for partial rental periods (invoices only) - `refund`: Refund line with negative amount - `delivery_rate`: Delivery charge based on carrier rates - `legacy_migration`: Legacy proration line<br>Only `charge` and `section` line types can be created through the resource. Other types are created by the system.<br> One of: `section`, `deposit_charge`, `proration`, `charge`, `legacy_migration`, `delivery_rate`.
`data[attributes][original_charge_label]` | **string** <br>The original charge label of the product (without price rule adjustments). 
`data[attributes][owner_id]` | **uuid** <br>The resource this Line belongs to. Either the [Order](#orders) directly, or a [Document](#documents). 
`data[attributes][owner_type]` | **enum** <br>The resource type of the owner.<br>One of: `orders`, `documents`.
`data[attributes][position]` | **integer** <br>The ordering of lines on an order or document. See [this section](#lines-fetching-an-item-sorting-lines) to understand how to sort when using bundles. 
`data[attributes][price_each_in_cents]` | **integer** <br>Price of each line. 
`data[attributes][price_tile_id]` | **uuid** <br>The [PriceTile](#price-tiles) that was selected to calculate the price. 
`data[attributes][quantity]` | **integer** <br>The quantity to calculate with. When updating quantity of a line with an associated planning, the planning also gets updated, which may lead to a shortage error. 
`data[attributes][tax_category_id]` | **uuid** <br>[TaxCategory](#tax-categories) applied to this Line. 
`data[attributes][taxable]` | **boolean** <br>Whether line is taxable. 
`data[attributes][title]` | **string** <br>Title of the line. 


### Includes

This request accepts the following includes:

<ul>
  <li>
    <code>nested_lines</code>
    <ul>
      <li><code>planning</code></li>
    </ul>
  </li>
  <li>
    <code>order</code>
    <ul>
      <li><code>tax_values</code></li>
    </ul>
  </li>
  <li>
    <code>owner</code>
    <ul>
      <li><code>tax_values</code></li>
    </ul>
  </li>
  <li><code>parent_line</code></li>
  <li>
    <code>planning</code>
    <ul>
      <li>
          <code>item</code>
          <ul>
            <li><code>photo</code></li>
          </ul>
      </li>
    </ul>
  </li>
  <li><code>tax_category</code></li>
</ul>


## Update a line

Change information, pricing, or increase the quantity of a line. Note that when updating the quantity of a line associated with a planning, the quantity of the planning will also be updated, which may result in a shortage error.

Order totals are automatically re-calculated after updating a line and an invoice sync will be triggered if changes are relevant.

> How to update a line:

```shell
  curl --request PUT
       --url 'https://example.booqable.com/api/4/lines/fc2e8815-5ad2-4d0b-8a28-777a6b57d933'
       --header 'content-type: application/json'
       --data '{
         "data": {
           "id": "fc2e8815-5ad2-4d0b-8a28-777a6b57d933",
           "type": "lines",
           "attributes": {
             "price_each_in_cents": 1000
           }
         }
       }'
```

> A 200 status response looks like this:

```json
  {
    "data": {
      "id": "fc2e8815-5ad2-4d0b-8a28-777a6b57d933",
      "type": "lines",
      "attributes": {
        "created_at": "2027-03-06T23:03:01.000000+00:00",
        "updated_at": "2027-03-06T23:03:01.000000+00:00",
        "archived": false,
        "archived_at": null,
        "title": "Macbook Pro",
        "extra_information": "Comes with a mouse",
        "quantity": 1,
        "original_price_each_in_cents": 72500,
        "original_charge_length": null,
        "original_charge_label": null,
        "price_each_in_cents": 1000,
        "price_in_cents": 1000,
        "position": 1,
        "charge_label": "29 days",
        "charge_length": 2505600,
        "price_rule_values": null,
        "discountable": true,
        "taxable": true,
        "line_type": "charge",
        "relevant": true,
        "order_id": "33b62e2b-8553-4919-8719-0de973ab048e",
        "item_id": "6079761a-dac1-4eb8-88a9-d5c43040d760",
        "tax_category_id": "87821aa9-fd93-4b69-8e67-01c17fd816d6",
        "price_structure_id": null,
        "price_tile_id": null,
        "planning_id": "cdd8227f-b71f-41ae-83a9-4e47d0c1a2b6",
        "parent_line_id": null,
        "owner_id": "33b62e2b-8553-4919-8719-0de973ab048e",
        "owner_type": "orders"
      },
      "relationships": {}
    },
    "meta": {}
  }
```

### HTTP Request

`PUT /api/4/lines/{id}`

### Request params

This request accepts the following parameters:

Name | Description
-- | --
`fields[]` | **array** <br>List of comma separated fields to include instead of the default fields. `?fields[lines]=created_at,updated_at,archived`
`include` | **string** <br>List of comma seperated relationships to sideload. `?include=order,owner,tax_category`


### Request body

This request accepts the following body:

Name | Description
-- | --
`data[attributes][charge_label]` | **string** <br>Charge label. 
`data[attributes][charge_length]` | **integer** <br>The charge length in seconds. It can be different than the time planned. Setting `charge_length` to `null` will trigger recalculation of the price based on order period and price rules. <br/> To recalculate prices for the entire order, use [OrderPriceRecalculation](#order-price-recalculations). 
`data[attributes][confirm_shortage]` | **boolean** <br>Whether to confirm a shortage when updating quantity on a line. When a line has an associated planning and you increase the quantity, the planning's quantity will also be increased. If this results in a shortage (requested quantity exceeds available inventory), the update will fail with a shortage error.<br>Setting this to `true` confirms that you want to proceed with the update despite the shortage. This is useful when you know you'll be able to fulfill the order through other means, such as acquiring additional inventory before the rental period.<br>Overriding shortage warnings is only possible when the ProductGroup is configured to allow shortage. 
`data[attributes][discountable]` | **boolean** <br>Whether line is discountable. 
`data[attributes][extra_information]` | **string** <br>Extra information about the line. 
`data[attributes][line_type]` | **enum** <br>Type of line. Can be one of: - `charge`: Regular charge line for rental items or custom charges - `section`: Visual section for organizing lines (no financial impact) - `deposit_charge`: Deposit charge line - `proration`: Partial charge for partial rental periods (invoices only) - `refund`: Refund line with negative amount - `delivery_rate`: Delivery charge based on carrier rates - `legacy_migration`: Legacy proration line<br>Only `charge` and `section` line types can be created through the resource. Other types are created by the system.<br> One of: `section`, `deposit_charge`, `proration`, `charge`, `legacy_migration`, `delivery_rate`.
`data[attributes][original_charge_label]` | **string** <br>The original charge label of the product (without price rule adjustments). 
`data[attributes][owner_id]` | **uuid** <br>The resource this Line belongs to. Either the [Order](#orders) directly, or a [Document](#documents). 
`data[attributes][owner_type]` | **enum** <br>The resource type of the owner.<br>One of: `orders`, `documents`.
`data[attributes][position]` | **integer** <br>The ordering of lines on an order or document. See [this section](#lines-fetching-an-item-sorting-lines) to understand how to sort when using bundles. 
`data[attributes][price_each_in_cents]` | **integer** <br>Price of each line. 
`data[attributes][price_tile_id]` | **uuid** <br>The [PriceTile](#price-tiles) that was selected to calculate the price. 
`data[attributes][quantity]` | **integer** <br>The quantity to calculate with. When updating quantity of a line with an associated planning, the planning also gets updated, which may lead to a shortage error. 
`data[attributes][tax_category_id]` | **uuid** <br>[TaxCategory](#tax-categories) applied to this Line. 
`data[attributes][taxable]` | **boolean** <br>Whether line is taxable. 
`data[attributes][title]` | **string** <br>Title of the line. 


### Includes

This request accepts the following includes:

<ul>
  <li>
    <code>nested_lines</code>
    <ul>
      <li><code>planning</code></li>
    </ul>
  </li>
  <li>
    <code>order</code>
    <ul>
      <li><code>tax_values</code></li>
    </ul>
  </li>
  <li>
    <code>owner</code>
    <ul>
      <li><code>tax_values</code></li>
    </ul>
  </li>
  <li><code>parent_line</code></li>
  <li>
    <code>planning</code>
    <ul>
      <li>
          <code>item</code>
          <ul>
            <li><code>photo</code></li>
          </ul>
      </li>
    </ul>
  </li>
  <li><code>tax_category</code></li>
</ul>


## Archive a line


> How to delete a line:

```shell
  curl --request DELETE
       --url 'https://example.booqable.com/api/4/lines/4ad8090f-0878-4fb1-8e5e-2dea58fd8ef6'
       --header 'content-type: application/json'
```

> A 200 status response looks like this:

```json
  {
    "data": {
      "id": "4ad8090f-0878-4fb1-8e5e-2dea58fd8ef6",
      "type": "lines",
      "attributes": {
        "created_at": "2018-12-01T08:17:02.000000+00:00",
        "updated_at": "2018-12-01T08:17:02.000000+00:00",
        "archived": true,
        "archived_at": "2018-12-01T08:17:02.000000+00:00",
        "title": "Macbook Pro",
        "extra_information": "Comes with a mouse",
        "quantity": 1,
        "original_price_each_in_cents": 72500,
        "original_charge_length": null,
        "original_charge_label": null,
        "price_each_in_cents": 80250,
        "price_in_cents": 80250,
        "position": 1,
        "charge_label": "29 days",
        "charge_length": 2505600,
        "price_rule_values": {
          "charge": {
            "from": "1973-03-11T17:00:02.000000+00:00",
            "till": "1973-04-09T17:00:02.000000+00:00",
            "adjustments": [
              {
                "name": "Pickup day"
              },
              {
                "name": "Return day"
              }
            ]
          },
          "price": [
            {
              "name": "High-Season",
              "charge_length": 1339200,
              "multiplier": "0.2",
              "price_in_cents": 7750,
              "adjustments": [
                {
                  "from": "1973-03-25T05:00:02.000000+00:00",
                  "till": "1973-04-09T17:00:02.000000+00:00",
                  "charge_length": 1339200,
                  "charge_label": "372 hours",
                  "price_in_cents": 7750
                }
              ],
              "stacked": false
            }
          ]
        },
        "discountable": true,
        "taxable": true,
        "line_type": "charge",
        "relevant": true,
        "order_id": "78b392bd-6db0-4fb7-8eee-93b320eb554e",
        "item_id": "914563ce-67a8-43f6-8d3a-bcd5476a2575",
        "tax_category_id": "1f32b2e1-dd8e-4304-8d68-68f0077e18b7",
        "price_structure_id": null,
        "price_tile_id": null,
        "planning_id": "372352f3-b88b-4b67-80e6-e89b803c2fb4",
        "parent_line_id": null,
        "owner_id": "78b392bd-6db0-4fb7-8eee-93b320eb554e",
        "owner_type": "orders"
      },
      "relationships": {}
    },
    "meta": {}
  }
```

### HTTP Request

`DELETE /api/4/lines/{id}`

### Request params

This request accepts the following parameters:

Name | Description
-- | --
`fields[]` | **array** <br>List of comma separated fields to include instead of the default fields. `?fields[lines]=created_at,updated_at,archived`
`include` | **string** <br>List of comma seperated relationships to sideload. `?include=order,owner,tax_category`


### Includes

This request accepts the following includes:

<ul>
  <li>
    <code>order</code>
    <ul>
      <li><code>tax_values</code></li>
    </ul>
  </li>
  <li>
    <code>owner</code>
    <ul>
      <li><code>tax_values</code></li>
    </ul>
  </li>
  <li><code>parent_line</code></li>
  <li><code>tax_category</code></li>
</ul>

