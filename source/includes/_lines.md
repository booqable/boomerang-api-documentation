# Lines

Lines make up the individual elements of an order, document, or cart. They contain information about pricing, planning, or markup. A key concept about lines is that there are two kinds:

1. **Custom lines** Lines created through the resource that don't have a planning associated with it.
   Can be of one of type `charge`, `section`.

2. **Planning lines** Lines that have a planning associated with it, these lines can not be created through
   the Line resource but are created by submitting a `book_*` action to [OrderFulfilments](#order-fulfilments).
   Updating or destroying a line linked to a planning will also destroy the planning.

Note that lines can only be created for orders. On invoices, lines are automatically generated based on price changes of the order. For quotes and contracts, lines are generated through the [Document](#documents) resource.

**A line can have one of the following types:**

- `section` Behaves as a (visual) section on orders and documents.
- `charge` Regular charge line which contains price information.
- `deposit_charge` A deposit charge line generated by a deposit hold action. This line is always calculated from a price including taxes.
- `proration` Whether this line is a proration, these lines only appear on invoices and can't be updated or destroyed by the resource; they are automatically synced.
- `refund` This line was created due to a refund.
- `legacy_migration` Proration bundled as one line. This lines appear on invoices that were made before Booqable was able to sync invoices automatically.

Nested lines contain information about individual items in a bundle; for these lines, the quantity and price information can not be updated directly but should be updated through the parent line instead.

## Endpoints
`GET /api/boomerang/lines`

`GET /api/boomerang/lines/{id}`

`POST /api/boomerang/lines`

`PUT /api/boomerang/lines/{id}`

`DELETE /api/boomerang/lines/{id}`

## Fields
Every line has the following fields:

Name | Description
-- | --
`id` | **Uuid** `readonly`<br>Primary key
`created_at` | **Datetime** `readonly`<br>When the resource was created
`updated_at` | **Datetime** `readonly`<br>When the resource was last updated
`archived` | **Boolean** `readonly`<br>Whether line is archived
`archived_at` | **Datetime** `nullable` `readonly`<br>When the line was archived
`title` | **String** `nullable`<br>Title of the line
`extra_information` | **String** `nullable`<br>Extra information about the line
`quantity` | **Integer** <br>The quantity to calculate with. When updating quantity of a line with an associated planning, the planning also gets updated, which may lead to a shortage error
`original_price_each_in_cents` | **Integer** `readonly`<br>The original price of the product (without price rule adjustments)
`original_charge_length` | **Integer** `readonly`<br>The original charge length of the product (without price rule adjustments)
`original_charge_label` | **String** `nullable`<br>The original charge label of the product (without price rule adjustments)
`price_each_in_cents` | **Integer** <br>Price of each line
`price_in_cents` | **Integer** `readonly`<br>Price of each line x quantity
`display_price_in_cents` | **Integer** `readonly`<br>Price of this line to display based on the tax setting of the company (inclusive vs. exclusive)
`position` | **Integer** `nullable`<br>Which position the line has
`charge_label` | **String** `nullable`<br>Charge label
`charge_length` | **Integer** `nullable`<br>The charge length in seconds. It can be different than the time planned. Set to null to recalculate pricing based on order period and apply price rules.
`price_rule_values` | **Hash** `nullable` `readonly`<br>Breakdown of applied price rules
`discountable` | **Boolean** <br>Whether line is discountable
`taxable` | **Boolean** <br>Whether line is taxable
`line_type` | **String** <br>One of `section`, `deposit_charge`, `proration`, `charge`, `legacy_migration`
`relevant` | **Boolean** `readonly`<br>Whether line is relevant. If not, line has no visible change, it's only used for reporting
`confirm_shortage` | **Boolean** `writeonly`<br>Whether to confirm a shortage when updating quantity on a line
`order_id` | **Uuid** `readonly`<br>The associated Order
`item_id` | **Uuid** `nullable` `readonly`<br>The associated Item
`tax_category_id` | **Uuid** `nullable`<br>The associated Tax category
`planning_id` | **Uuid** `readonly`<br>The associated Planning
`price_structure_id` | **Uuid** <br>The associated Price structure
`price_tile_id` | **Uuid** <br>The associated Price tile
`parent_line_id` | **Uuid** `readonly`<br>The associated Parent line
`owner_id` | **Uuid** <br>ID of its owner
`owner_type` | **String** <br>One of `orders`, `documents`, `carts`


## Relationships
Lines have the following relationships:

Name | Description
-- | --
`order` | **Orders** `readonly`<br>Associated Order
`item` | **Items** `readonly`<br>Associated Item
`tax_category` | **Tax categories** `readonly`<br>Associated Tax category
`planning` | **Plannings** `readonly`<br>Associated Planning
`price_structure` | **Price structures** `readonly`<br>Associated Price structure
`price_tile` | **Price tiles** `readonly`<br>Associated Price tile
`parent_line` | **Lines** `readonly`<br>Associated Parent line
`nested_lines` | **Lines** `readonly`<br>Associated Nested lines
`owner` | **Order**<br>Associated Owner


## Listing lines



> How to fetch a list of lines:

```shell
  curl --request GET \
    --url 'https://example.booqable.com/api/boomerang/lines' \
    --header 'content-type: application/json' \
```

> A 200 status response looks like this:

```json
  {
  "data": [
    {
      "id": "6375f730-ae95-42b0-a3e4-660e1d6c39f2",
      "type": "lines",
      "attributes": {
        "created_at": "2024-07-29T09:22:45.455592+00:00",
        "updated_at": "2024-07-29T09:22:45.483771+00:00",
        "archived": false,
        "archived_at": null,
        "title": "Macbook Pro",
        "extra_information": "Comes with a mouse",
        "quantity": 1,
        "original_price_each_in_cents": 72500,
        "original_charge_length": null,
        "original_charge_label": null,
        "price_each_in_cents": 80250,
        "price_in_cents": 80250,
        "display_price_in_cents": 80250,
        "position": 1,
        "charge_label": "29 days",
        "charge_length": 2505600,
        "price_rule_values": {
          "charge": {
            "from": "1980-04-02T00:00:00.000Z",
            "till": "1980-05-01T00:00:00.000Z",
            "adjustments": [
              {
                "name": "Pickup day"
              },
              {
                "name": "Return day"
              }
            ]
          },
          "price": [
            {
              "name": "High-Season",
              "charge_length": 1339200,
              "multiplier": "0.2",
              "price_in_cents": 7750,
              "adjustments": [
                {
                  "from": "1980-04-15T12:00:00.000Z",
                  "till": "1980-05-01T00:00:00.000Z",
                  "charge_length": 1339200,
                  "charge_label": "372 hours",
                  "price_in_cents": 7750
                }
              ],
              "stacked": false
            }
          ]
        },
        "discountable": true,
        "taxable": true,
        "line_type": "charge",
        "relevant": true,
        "order_id": "b5e9a90d-44b3-43e0-bd25-f973fbfa6d34",
        "item_id": "c4916074-5c8c-4f61-bc84-c0d891bb35f6",
        "tax_category_id": "7fc7e73b-9df9-4439-9191-c71e75cd5cc6",
        "planning_id": "b2396ae4-4dd4-4441-97a9-144604eaa25f",
        "price_structure_id": null,
        "price_tile_id": null,
        "parent_line_id": null,
        "owner_id": "b5e9a90d-44b3-43e0-bd25-f973fbfa6d34",
        "owner_type": "orders"
      },
      "relationships": {}
    }
  ],
  "meta": {}
}
```

### HTTP Request

`GET /api/boomerang/lines`

### Request params

This request accepts the following parameters:

Name | Description
-- | --
`include` | **String** <br>List of comma seperated relationships `?include=order,owner,tax_category`
`fields[]` | **Array** <br>List of comma seperated fields to include `?fields[lines]=created_at,updated_at,archived`
`filter` | **Hash** <br>The filters to apply `?filter[attribute][eq]=value`
`sort` | **String** <br>How to sort the data `?sort=attribute1,-attribute2`
`meta` | **Hash** <br>Metadata to send along `?meta[total][]=count`
`page[number]` | **String** <br>The page to request
`page[size]` | **String** <br>The amount of items per page (max 100)


### Filters

This request can be filtered on:

Name | Description
-- | --
`id` | **Uuid** <br>`eq`, `not_eq`
`created_at` | **Datetime** <br>`eq`, `not_eq`, `gt`, `gte`, `lt`, `lte`
`updated_at` | **Datetime** <br>`eq`, `not_eq`, `gt`, `gte`, `lt`, `lte`
`archived` | **Boolean** <br>`eq`
`archived_at` | **Datetime** <br>`eq`, `not_eq`, `gt`, `gte`, `lt`, `lte`
`title` | **String** <br>`eq`, `not_eq`, `eql`, `not_eql`, `prefix`, `not_prefix`, `suffix`, `not_suffix`, `match`, `not_match`
`quantity` | **Integer** <br>`eq`, `not_eq`, `gt`, `gte`, `lt`, `lte`
`discountable` | **Boolean** <br>`eq`
`taxable` | **Boolean** <br>`eq`
`line_type` | **String** <br>`eq`, `not_eq`, `eql`, `not_eql`, `prefix`, `not_prefix`, `suffix`, `not_suffix`, `match`, `not_match`
`relevant` | **Boolean** <br>`eq`
`order_id` | **Uuid** <br>`eq`
`item_id` | **Uuid** <br>`eq`, `not_eq`
`tax_category_id` | **Uuid** <br>`eq`, `not_eq`
`planning_id` | **Uuid** <br>`eq`, `not_eq`
`price_structure_id` | **Uuid** <br>`eq`, `not_eq`
`price_tile_id` | **Uuid** <br>`eq`, `not_eq`
`parent_line_id` | **Uuid** <br>`eq`, `not_eq`
`owner_id` | **Uuid** <br>`eq`, `not_eq`
`owner_type` | **String** <br>`eq`, `not_eq`


### Meta

Results can be aggregated on:

Name | Description
-- | --
`total` | **Array** <br>`count`


### Includes

This request accepts the following includes:

`order`


`owner`


`tax_category`


`planning` => 
`item` => 
`photo`










## Fetching a line



> How to fetch a line:

```shell
  curl --request GET \
    --url 'https://example.booqable.com/api/boomerang/lines/3b77c751-6eb0-4e19-a2ea-10386b1fdc30' \
    --header 'content-type: application/json' \
```

> A 200 status response looks like this:

```json
  {
  "data": {
    "id": "3b77c751-6eb0-4e19-a2ea-10386b1fdc30",
    "type": "lines",
    "attributes": {
      "created_at": "2024-07-29T09:22:50.070897+00:00",
      "updated_at": "2024-07-29T09:22:50.099796+00:00",
      "archived": false,
      "archived_at": null,
      "title": "Macbook Pro",
      "extra_information": "Comes with a mouse",
      "quantity": 1,
      "original_price_each_in_cents": 72500,
      "original_charge_length": null,
      "original_charge_label": null,
      "price_each_in_cents": 80250,
      "price_in_cents": 80250,
      "display_price_in_cents": 80250,
      "position": 1,
      "charge_label": "29 days",
      "charge_length": 2505600,
      "price_rule_values": {
        "charge": {
          "from": "1980-04-02T00:00:00.000Z",
          "till": "1980-05-01T00:00:00.000Z",
          "adjustments": [
            {
              "name": "Pickup day"
            },
            {
              "name": "Return day"
            }
          ]
        },
        "price": [
          {
            "name": "High-Season",
            "charge_length": 1339200,
            "multiplier": "0.2",
            "price_in_cents": 7750,
            "adjustments": [
              {
                "from": "1980-04-15T12:00:00.000Z",
                "till": "1980-05-01T00:00:00.000Z",
                "charge_length": 1339200,
                "charge_label": "372 hours",
                "price_in_cents": 7750
              }
            ],
            "stacked": false
          }
        ]
      },
      "discountable": true,
      "taxable": true,
      "line_type": "charge",
      "relevant": true,
      "order_id": "7a1e196d-4644-4852-b843-cab4922ae0c1",
      "item_id": "4826cbdb-8535-451b-8326-1b45b9a8b0f9",
      "tax_category_id": "3213f83c-ba51-49c9-bafe-be391ee65011",
      "planning_id": "4346e2a6-6317-4571-9ead-f190ca18c2fa",
      "price_structure_id": null,
      "price_tile_id": null,
      "parent_line_id": null,
      "owner_id": "7a1e196d-4644-4852-b843-cab4922ae0c1",
      "owner_type": "orders"
    },
    "relationships": {}
  },
  "meta": {}
}
```

### HTTP Request

`GET /api/boomerang/lines/{id}`

### Request params

This request accepts the following parameters:

Name | Description
-- | --
`include` | **String** <br>List of comma seperated relationships `?include=order,owner,tax_category`
`fields[]` | **Array** <br>List of comma seperated fields to include `?fields[lines]=created_at,updated_at,archived`


### Includes

This request accepts the following includes:

`order` => 
`tax_values`




`owner` => 
`tax_values`




`tax_category`


`parent_line`


`nested_lines` => 
`planning`




`planning` => 
`item` => 
`photo`










## Creating a line

Lines created through this endpoint, so-called custom lines, can only have the type `charge` or `section`.
Custom `charge` lines enable you to add charges not (directly) connected to a product to an order.
Sections allow to add some organization to orders.

Order totals are automatically re-calculated after the creation of a new line and an invoice sync will be triggered if changes are relevant.


> How to create a line:

```shell
  curl --request POST \
    --url 'https://example.booqable.com/api/boomerang/lines' \
    --header 'content-type: application/json' \
    --data '{
      "data": {
        "type": "lines",
        "attributes": {
          "owner_id": "9dac2d91-7d51-4923-80a7-43c90c9c207f",
          "owner_type": "orders",
          "price_each_in_cents": 1000
        }
      }
    }'
```

> A 201 status response looks like this:

```json
  {
  "data": {
    "id": "9188603e-79aa-4368-adf3-f0f4d24a120f",
    "type": "lines",
    "attributes": {
      "created_at": "2024-07-29T09:22:52.812888+00:00",
      "updated_at": "2024-07-29T09:22:52.821251+00:00",
      "archived": false,
      "archived_at": null,
      "title": null,
      "extra_information": null,
      "quantity": 1,
      "original_price_each_in_cents": null,
      "original_charge_length": null,
      "original_charge_label": null,
      "price_each_in_cents": 1000,
      "price_in_cents": 1000,
      "display_price_in_cents": 1000,
      "position": 1,
      "charge_label": null,
      "charge_length": null,
      "price_rule_values": null,
      "discountable": true,
      "taxable": true,
      "line_type": "charge",
      "relevant": true,
      "order_id": "9dac2d91-7d51-4923-80a7-43c90c9c207f",
      "item_id": null,
      "tax_category_id": null,
      "planning_id": null,
      "price_structure_id": null,
      "price_tile_id": null,
      "parent_line_id": null,
      "owner_id": "9dac2d91-7d51-4923-80a7-43c90c9c207f",
      "owner_type": "orders"
    },
    "relationships": {}
  },
  "meta": {}
}
```

### HTTP Request

`POST /api/boomerang/lines`

### Request params

This request accepts the following parameters:

Name | Description
-- | --
`include` | **String** <br>List of comma seperated relationships `?include=order,owner,tax_category`
`fields[]` | **Array** <br>List of comma seperated fields to include `?fields[lines]=created_at,updated_at,archived`


### Request body

This request accepts the following body:

Name | Description
-- | --
`data[attributes][title]` | **String** <br>Title of the line
`data[attributes][extra_information]` | **String** <br>Extra information about the line
`data[attributes][quantity]` | **Integer** <br>The quantity to calculate with. When updating quantity of a line with an associated planning, the planning also gets updated, which may lead to a shortage error
`data[attributes][original_charge_label]` | **String** <br>The original charge label of the product (without price rule adjustments)
`data[attributes][price_each_in_cents]` | **Integer** <br>Price of each line
`data[attributes][position]` | **Integer** <br>Which position the line has
`data[attributes][charge_label]` | **String** <br>Charge label
`data[attributes][charge_length]` | **Integer** <br>The charge length in seconds. It can be different than the time planned. Set to null to recalculate pricing based on order period and apply price rules.
`data[attributes][discountable]` | **Boolean** <br>Whether line is discountable
`data[attributes][taxable]` | **Boolean** <br>Whether line is taxable
`data[attributes][line_type]` | **String** <br>One of `section`, `deposit_charge`, `proration`, `charge`, `legacy_migration`
`data[attributes][confirm_shortage]` | **Boolean** <br>Whether to confirm a shortage when updating quantity on a line
`data[attributes][tax_category_id]` | **Uuid** <br>The associated Tax category
`data[attributes][price_structure_id]` | **Uuid** <br>The associated Price structure
`data[attributes][price_tile_id]` | **Uuid** <br>The associated Price tile
`data[attributes][owner_id]` | **Uuid** <br>ID of its owner
`data[attributes][owner_type]` | **String** <br>One of `orders`, `documents`, `carts`


### Includes

This request accepts the following includes:

`order` => 
`tax_values`




`owner` => 
`tax_values`




`tax_category`


`parent_line`


`nested_lines` => 
`planning`




`planning` => 
`item` => 
`photo`










## Updating a line

Change information, pricing, or increase the quantity of a line. Note that when updating the quantity of a line associated with a planning, the quantity of the planninig will also be updated, which may result in a shortage error.

Order totals are automatically re-calculated after updating a line and an invoice sync will be triggered if changes are relevant.


> How to update a line:

```shell
  curl --request PUT \
    --url 'https://example.booqable.com/api/boomerang/lines/56fd85b2-2a5f-4c0a-a60f-717eb12293b1' \
    --header 'content-type: application/json' \
    --data '{
      "data": {
        "id": "56fd85b2-2a5f-4c0a-a60f-717eb12293b1",
        "type": "lines",
        "attributes": {
          "price_each_in_cents": 1000
        }
      }
    }'
```

> A 200 status response looks like this:

```json
  {
  "data": {
    "id": "56fd85b2-2a5f-4c0a-a60f-717eb12293b1",
    "type": "lines",
    "attributes": {
      "created_at": "2024-07-29T09:22:43.278660+00:00",
      "updated_at": "2024-07-29T09:22:44.085405+00:00",
      "archived": false,
      "archived_at": null,
      "title": "Macbook Pro",
      "extra_information": "Comes with a mouse",
      "quantity": 1,
      "original_price_each_in_cents": 72500,
      "original_charge_length": null,
      "original_charge_label": null,
      "price_each_in_cents": 1000,
      "price_in_cents": 1000,
      "display_price_in_cents": 1000,
      "position": 1,
      "charge_label": "29 days",
      "charge_length": 2505600,
      "price_rule_values": null,
      "discountable": true,
      "taxable": true,
      "line_type": "charge",
      "relevant": true,
      "order_id": "42c0396b-9715-4a70-8481-7b68f5daea98",
      "item_id": "cc7b02f5-c7f1-411a-95a4-037e3c095fa0",
      "tax_category_id": "c4fde4bd-5c0e-4807-87a6-48fc93df3ff2",
      "planning_id": "38ce51ee-9880-4351-a617-7f53accbff40",
      "price_structure_id": null,
      "price_tile_id": null,
      "parent_line_id": null,
      "owner_id": "42c0396b-9715-4a70-8481-7b68f5daea98",
      "owner_type": "orders"
    },
    "relationships": {}
  },
  "meta": {}
}
```

### HTTP Request

`PUT /api/boomerang/lines/{id}`

### Request params

This request accepts the following parameters:

Name | Description
-- | --
`include` | **String** <br>List of comma seperated relationships `?include=order,owner,tax_category`
`fields[]` | **Array** <br>List of comma seperated fields to include `?fields[lines]=created_at,updated_at,archived`


### Request body

This request accepts the following body:

Name | Description
-- | --
`data[attributes][title]` | **String** <br>Title of the line
`data[attributes][extra_information]` | **String** <br>Extra information about the line
`data[attributes][quantity]` | **Integer** <br>The quantity to calculate with. When updating quantity of a line with an associated planning, the planning also gets updated, which may lead to a shortage error
`data[attributes][original_charge_label]` | **String** <br>The original charge label of the product (without price rule adjustments)
`data[attributes][price_each_in_cents]` | **Integer** <br>Price of each line
`data[attributes][position]` | **Integer** <br>Which position the line has
`data[attributes][charge_label]` | **String** <br>Charge label
`data[attributes][charge_length]` | **Integer** <br>The charge length in seconds. It can be different than the time planned. Set to null to recalculate pricing based on order period and apply price rules.
`data[attributes][discountable]` | **Boolean** <br>Whether line is discountable
`data[attributes][taxable]` | **Boolean** <br>Whether line is taxable
`data[attributes][line_type]` | **String** <br>One of `section`, `deposit_charge`, `proration`, `charge`, `legacy_migration`
`data[attributes][confirm_shortage]` | **Boolean** <br>Whether to confirm a shortage when updating quantity on a line
`data[attributes][tax_category_id]` | **Uuid** <br>The associated Tax category
`data[attributes][price_structure_id]` | **Uuid** <br>The associated Price structure
`data[attributes][price_tile_id]` | **Uuid** <br>The associated Price tile
`data[attributes][owner_id]` | **Uuid** <br>ID of its owner
`data[attributes][owner_type]` | **String** <br>One of `orders`, `documents`, `carts`


### Includes

This request accepts the following includes:

`order` => 
`tax_values`




`owner` => 
`tax_values`




`tax_category`


`parent_line`


`nested_lines` => 
`planning`




`planning` => 
`item` => 
`photo`










## Archiving a line



> How to delete a line:

```shell
  curl --request DELETE \
    --url 'https://example.booqable.com/api/boomerang/lines/09922460-afbe-4529-9919-ea0fa5c9a04a' \
    --header 'content-type: application/json' \
```

> A 200 status response looks like this:

```json
  {
  "data": {
    "id": "09922460-afbe-4529-9919-ea0fa5c9a04a",
    "type": "lines",
    "attributes": {
      "created_at": "2024-07-29T09:22:47.381619+00:00",
      "updated_at": "2024-07-29T09:22:48.116811+00:00",
      "archived": true,
      "archived_at": "2024-07-29T09:22:48.116811+00:00",
      "title": "Macbook Pro",
      "extra_information": "Comes with a mouse",
      "quantity": 1,
      "original_price_each_in_cents": 72500,
      "original_charge_length": null,
      "original_charge_label": null,
      "price_each_in_cents": 80250,
      "price_in_cents": 80250,
      "display_price_in_cents": 80250,
      "position": 1,
      "charge_label": "29 days",
      "charge_length": 2505600,
      "price_rule_values": {
        "charge": {
          "from": "1980-04-02T00:00:00.000Z",
          "till": "1980-05-01T00:00:00.000Z",
          "adjustments": [
            {
              "name": "Pickup day"
            },
            {
              "name": "Return day"
            }
          ]
        },
        "price": [
          {
            "name": "High-Season",
            "charge_length": 1339200,
            "multiplier": "0.2",
            "price_in_cents": 7750,
            "adjustments": [
              {
                "from": "1980-04-15T12:00:00.000Z",
                "till": "1980-05-01T00:00:00.000Z",
                "charge_length": 1339200,
                "charge_label": "372 hours",
                "price_in_cents": 7750
              }
            ],
            "stacked": false
          }
        ]
      },
      "discountable": true,
      "taxable": true,
      "line_type": "charge",
      "relevant": true,
      "order_id": "9f0afbe4-83f1-4870-a60f-314927098ce0",
      "item_id": "87b84293-a13c-4d2d-9eff-39bf6522a280",
      "tax_category_id": "ac104006-3160-4516-a0c2-65d938998b42",
      "planning_id": "9940d795-df67-4fea-b91d-d53a6057d476",
      "price_structure_id": null,
      "price_tile_id": null,
      "parent_line_id": null,
      "owner_id": "9f0afbe4-83f1-4870-a60f-314927098ce0",
      "owner_type": "orders"
    },
    "relationships": {}
  },
  "meta": {}
}
```

### HTTP Request

`DELETE /api/boomerang/lines/{id}`

### Request params

This request accepts the following parameters:

Name | Description
-- | --
`include` | **String** <br>List of comma seperated relationships `?include=order,owner,tax_category`
`fields[]` | **Array** <br>List of comma seperated fields to include `?fields[lines]=created_at,updated_at,archived`


### Includes

This request accepts the following includes:

`order` => 
`tax_values`




`owner` => 
`tax_values`




`tax_category`





