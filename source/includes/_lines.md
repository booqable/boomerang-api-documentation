# Lines

Lines make up the individual elements of an order, document, or cart. They contain information about pricing, planning, or markup. A key concept about lines is that there are two kinds:

1. **Custom lines** Lines created through the resource that don't have a planning associated with it. Can be of one of type `charge`, `section`.
2. **Planning lines** Lines that have a planning associated with it, these lines can't be created through the resource directly but only through a [order booking](#order-bookings)). Destroying a planning line will also destroy its associated planning.

Note that lines can only be created for orders. On invoices, lines are automatically generated based on price changes of the order. For quotes and contracts, lines are generated through the [Document](#documents) resource.

**A line can have one of the following types:**

- `section` Behaves as a (visual) section on orders and documents.
- `charge` Regular charge line which contains price information.
- `deposit_charge` A deposit charge line generated by a deposit hold action. This line is always calculated from a price including taxes.
- `proration` Whether this line is a proration, these lines only appear on invoices and can't be updated or destroyed by the resource; they are automatically synced.
- `refund` This line was created due to a refund.
- `legacy_migration` Proration bundled as one line. This lines appear on invoices that were made before Booqable was able to sync invoices automatically.

Nested lines contain information about individual items in a bundle; for these lines, the quantity and price information can not be updated directly but should be updated through the parent line instead.

## Endpoints
`GET /api/boomerang/lines`

`GET /api/boomerang/lines/{id}`

`POST /api/boomerang/lines`

`PUT /api/boomerang/lines/{id}`

`DELETE /api/boomerang/lines/{id}`

## Fields
Every line has the following fields:

Name | Description
- | -
`id` | **Uuid** `readonly`<br>Primary key
`created_at` | **Datetime** `readonly`<br>When the resource was created
`updated_at` | **Datetime** `readonly`<br>When the resource was last updated
`archived` | **Boolean** `readonly`<br>Whether line is archived
`archived_at` | **Datetime** `nullable` `readonly`<br>When the line was archived
`title` | **String** `nullable`<br>Title of the line
`extra_information` | **String** `nullable`<br>Extra information about the line
`quantity` | **Integer**<br>The quantity to calculate with. When updating quantity of a line with an associated planning, the planning also gets updated, which may lead to a shortage error
`original_price_each_in_cents` | **Integer** `readonly`<br>The original price of the product (without price rule adjustments)
`price_each_in_cents` | **Integer**<br>Price of each line
`price_in_cents` | **Integer** `readonly`<br>Price of each line x quantity
`position` | **Integer**<br>Which position the line has
`charge_label` | **String** `nullable`<br>Charge label
`charge_length` | **Integer** `nullable`<br>The charge length in seconds. It can be different than the time planned. Set to null to recalculate pricing based on order period and apply price rules.
`price_rule_values` | **Hash** `nullable` `readonly`<br>Breakdown of applied price rules
`discountable` | **Boolean**<br>Whether line is discountable
`taxable` | **Boolean**<br>Whether line is taxable
`line_type` | **String**<br>One of `section`, `deposit_charge`, `proration`, `charge`, `refund`, `legacy_migration`
`relevant` | **Boolean** `readonly`<br>Whether line is relevant. If not, line has no visible change, it's only used for reporting
`item_id` | **Uuid** `nullable` `readonly`<br>The associated Item
`tax_category_id` | **Uuid** `nullable`<br>The associated Tax category
`planning_id` | **Uuid** `readonly`<br>The associated Planning
`parent_line_id` | **Uuid** `readonly`<br>The associated Parent line
`owner_id` | **Uuid**<br>ID of its owner
`owner_type` | **String**<br>One of `orders`, `documents`, `carts`


## Relationships
Lines have the following relationships:

Name | Description
- | -
`item` | **Items** `readonly`<br>Associated Item
`tax_category` | **Tax categories** `readonly`<br>Associated Tax category
`planning` | **Plannings** `readonly`<br>Associated Planning
`parent_line` | **Lines** `readonly`<br>Associated Parent line
`nested_lines` | **Lines** `readonly`<br>Associated Nested lines
`owner` | **Order**<br>Associated Owner


## Listing lines



> How to fetch a list of lines:

```shell
  curl --request GET \
    --url 'https://example.booqable.com/api/boomerang/lines' \
    --header 'content-type: application/json' \
```

> A 200 status response looks like this:

```json
  {
  "data": [
    {
      "id": "8d69402a-5253-4bcb-aed1-04753b943b29",
      "type": "lines",
      "attributes": {
        "created_at": "2022-03-24T12:37:05+00:00",
        "updated_at": "2022-03-24T12:37:05+00:00",
        "archived": false,
        "archived_at": null,
        "title": "Macbook Pro",
        "extra_information": "Comes with a mouse",
        "quantity": 1,
        "original_price_each_in_cents": 72500,
        "price_each_in_cents": 80250,
        "price_in_cents": 80250,
        "position": 1,
        "charge_label": "29 days",
        "charge_length": 2505600,
        "price_rule_values": {
          "charge": {
            "from": "1980-04-02T00:00:00.000Z",
            "till": "1980-05-01T00:00:00.000Z"
          },
          "price": [
            {
              "name": "High-Season",
              "charge_length": 1339200,
              "multiplier": "0.2",
              "price_in_cents": "7750.0",
              "stacked": false
            }
          ]
        },
        "discountable": true,
        "taxable": true,
        "line_type": "charge",
        "relevant": true,
        "item_id": "fc414872-92b1-4340-b24f-6ae6ee08e594",
        "tax_category_id": "ef0ee6bd-3a25-4ced-8d51-9492ee9ac411",
        "planning_id": "3265a96b-3fb0-4a32-9442-d1314a1bea9a",
        "parent_line_id": null,
        "owner_id": "de44a57d-abbb-4d1b-967d-3886d563c84f",
        "owner_type": "orders"
      },
      "relationships": {
        "item": {
          "links": {
            "related": "api/boomerang/items/fc414872-92b1-4340-b24f-6ae6ee08e594"
          }
        },
        "tax_category": {
          "links": {
            "related": "api/boomerang/tax_categories/ef0ee6bd-3a25-4ced-8d51-9492ee9ac411"
          }
        },
        "planning": {
          "links": {
            "related": "api/boomerang/plannings/3265a96b-3fb0-4a32-9442-d1314a1bea9a"
          }
        },
        "parent_line": {
          "links": {
            "related": null
          }
        },
        "nested_lines": {
          "links": {
            "related": "api/boomerang/lines?filter[parent_line_id]=8d69402a-5253-4bcb-aed1-04753b943b29"
          }
        },
        "owner": {
          "links": {
            "related": "api/boomerang/orders/de44a57d-abbb-4d1b-967d-3886d563c84f"
          }
        }
      }
    }
  ],
  "meta": {}
}
```

### HTTP Request

`GET /api/boomerang/lines`

### Request params

This request accepts the following paramaters:

Name | Description
- | -
`include` | **String**<br>List of comma seperated relationships `?include=item,tax_category,planning`
`fields[]` | **Array**<br>List of comma seperated fields to include `?fields[lines]=id,created_at,updated_at`
`filter` | **Hash**<br>The filters to apply `?filter[created_at][gte]=2022-03-24T12:35:47Z`
`sort` | **String**<br>How to sort the data `?sort=-created_at`
`meta` | **Hash**<br>Metadata to send along `?meta[total][]=count`
`page[number]` | **String**<br>The page to request
`page[size]` | **String**<br>The amount of items per page (max 100)


### Filters

This request can be filtered on:

Name | Description
- | -
`id` | **Uuid**<br>`eq`, `not_eq`
`created_at` | **Datetime**<br>`eq`, `not_eq`, `gt`, `gte`, `lt`, `lte`
`updated_at` | **Datetime**<br>`eq`, `not_eq`, `gt`, `gte`, `lt`, `lte`
`archived` | **Boolean**<br>`eq`
`archived_at` | **Datetime**<br>`eq`, `not_eq`, `gt`, `gte`, `lt`, `lte`
`title` | **String**<br>`eq`, `not_eq`, `eql`, `not_eql`, `prefix`, `not_prefix`, `suffix`, `not_suffix`, `match`, `not_match`
`quantity` | **Integer**<br>`eq`, `not_eq`, `gt`, `gte`, `lt`, `lte`
`discountable` | **Boolean**<br>`eq`
`taxable` | **Boolean**<br>`eq`
`line_type` | **String**<br>`eq`, `not_eq`, `eql`, `not_eql`, `prefix`, `not_prefix`, `suffix`, `not_suffix`, `match`, `not_match`
`relevant` | **Boolean**<br>`eq`
`item_id` | **Uuid**<br>`eq`, `not_eq`
`tax_category_id` | **Uuid**<br>`eq`, `not_eq`
`planning_id` | **Uuid**<br>`eq`, `not_eq`
`parent_line_id` | **Uuid**<br>`eq`, `not_eq`
`owner_id` | **Uuid**<br>`eq`, `not_eq`
`owner_type` | **String**<br>`eq`, `not_eq`


### Meta

Results can be aggregated on:

Name | Description
- | -
`total` | **Array**<br>`count`


### Includes

This request accepts the following includes:

`owner`


`tax_category`


`planning` => 
`item` => 
`photo`










## Fetching a line



> How to fetch a line:

```shell
  curl --request GET \
    --url 'https://example.booqable.com/api/boomerang/lines/695e0b53-fc11-4f09-b433-b9cac96a7776' \
    --header 'content-type: application/json' \
```

> A 200 status response looks like this:

```json
  {
  "data": {
    "id": "695e0b53-fc11-4f09-b433-b9cac96a7776",
    "type": "lines",
    "attributes": {
      "created_at": "2022-03-24T12:37:07+00:00",
      "updated_at": "2022-03-24T12:37:07+00:00",
      "archived": false,
      "archived_at": null,
      "title": "Macbook Pro",
      "extra_information": "Comes with a mouse",
      "quantity": 1,
      "original_price_each_in_cents": 72500,
      "price_each_in_cents": 80250,
      "price_in_cents": 80250,
      "position": 1,
      "charge_label": "29 days",
      "charge_length": 2505600,
      "price_rule_values": {
        "charge": {
          "from": "1980-04-02T00:00:00.000Z",
          "till": "1980-05-01T00:00:00.000Z"
        },
        "price": [
          {
            "name": "High-Season",
            "charge_length": 1339200,
            "multiplier": "0.2",
            "price_in_cents": "7750.0",
            "stacked": false
          }
        ]
      },
      "discountable": true,
      "taxable": true,
      "line_type": "charge",
      "relevant": true,
      "item_id": "6d85fe33-c89b-49aa-91f8-d1d0b1b2cfe9",
      "tax_category_id": "ab948e65-0359-4481-a62c-4d67cfca52f8",
      "planning_id": "ea5c6f4c-2050-4548-85b5-9c9adc981b7e",
      "parent_line_id": null,
      "owner_id": "21c4931a-4f0f-4f7c-a2c2-8e9d7e2c3ab3",
      "owner_type": "orders"
    },
    "relationships": {
      "item": {
        "links": {
          "related": "api/boomerang/items/6d85fe33-c89b-49aa-91f8-d1d0b1b2cfe9"
        }
      },
      "tax_category": {
        "links": {
          "related": "api/boomerang/tax_categories/ab948e65-0359-4481-a62c-4d67cfca52f8"
        }
      },
      "planning": {
        "links": {
          "related": "api/boomerang/plannings/ea5c6f4c-2050-4548-85b5-9c9adc981b7e"
        }
      },
      "parent_line": {
        "links": {
          "related": null
        }
      },
      "nested_lines": {
        "links": {
          "related": "api/boomerang/lines?filter[parent_line_id]=695e0b53-fc11-4f09-b433-b9cac96a7776"
        }
      },
      "owner": {
        "links": {
          "related": "api/boomerang/orders/21c4931a-4f0f-4f7c-a2c2-8e9d7e2c3ab3"
        }
      }
    }
  },
  "meta": {}
}
```

### HTTP Request

`GET /api/boomerang/lines/{id}`

### Request params

This request accepts the following paramaters:

Name | Description
- | -
`include` | **String**<br>List of comma seperated relationships `?include=item,tax_category,planning`
`fields[]` | **Array**<br>List of comma seperated fields to include `?fields[lines]=id,created_at,updated_at`


### Includes

This request accepts the following includes:

`owner`


`tax_category`


`parent_line`


`nested_lines`


`planning` => 
`item` => 
`photo`










## Creating a line

Lines created through this endpoint, so-called custom lines, can only have the type `charge` or `section`. They enable you to add charges and organization which are not managed automatically through [bookings](#bookings).

Order totals are automatically re-calculated after the creation of a new line and an invoice sync will be triggered if changes are relevant.


> How to create a line:

```shell
  curl --request POST \
    --url 'https://example.booqable.com/api/boomerang/lines' \
    --header 'content-type: application/json' \
    --data '{
      "data": {
        "type": "lines",
        "attributes": {
          "owner_id": "7e0b6387-7ba5-428e-b40c-b29a1d5c2131",
          "owner_type": "orders",
          "price_each_in_cents": 1000
        }
      }
    }'
```

> A 201 status response looks like this:

```json
  {
  "data": {
    "id": "fc8df8fd-ee95-47b2-898c-a677537040e9",
    "type": "lines",
    "attributes": {
      "created_at": "2022-03-24T12:37:09+00:00",
      "updated_at": "2022-03-24T12:37:09+00:00",
      "archived": false,
      "archived_at": null,
      "title": null,
      "extra_information": null,
      "quantity": 1,
      "original_price_each_in_cents": null,
      "price_each_in_cents": 1000,
      "price_in_cents": 1000,
      "position": 1,
      "charge_label": null,
      "charge_length": null,
      "price_rule_values": null,
      "discountable": true,
      "taxable": true,
      "line_type": "charge",
      "relevant": true,
      "item_id": null,
      "tax_category_id": null,
      "planning_id": null,
      "parent_line_id": null,
      "owner_id": "7e0b6387-7ba5-428e-b40c-b29a1d5c2131",
      "owner_type": "orders"
    },
    "relationships": {
      "item": {
        "meta": {
          "included": false
        }
      },
      "tax_category": {
        "meta": {
          "included": false
        }
      },
      "planning": {
        "meta": {
          "included": false
        }
      },
      "parent_line": {
        "meta": {
          "included": false
        }
      },
      "nested_lines": {
        "meta": {
          "included": false
        }
      },
      "owner": {
        "meta": {
          "included": false
        }
      }
    }
  },
  "meta": {}
}
```

### HTTP Request

`POST /api/boomerang/lines`

### Request params

This request accepts the following paramaters:

Name | Description
- | -
`include` | **String**<br>List of comma seperated relationships `?include=item,tax_category,planning`
`fields[]` | **Array**<br>List of comma seperated fields to include `?fields[lines]=id,created_at,updated_at`


### Request body

This request accepts the following body:

Name | Description
- | -
`data[attributes][title]` | **String**<br>Title of the line
`data[attributes][extra_information]` | **String**<br>Extra information about the line
`data[attributes][quantity]` | **Integer**<br>The quantity to calculate with. When updating quantity of a line with an associated planning, the planning also gets updated, which may lead to a shortage error
`data[attributes][price_each_in_cents]` | **Integer**<br>Price of each line
`data[attributes][position]` | **Integer**<br>Which position the line has
`data[attributes][charge_label]` | **String**<br>Charge label
`data[attributes][charge_length]` | **Integer**<br>The charge length in seconds. It can be different than the time planned. Set to null to recalculate pricing based on order period and apply price rules.
`data[attributes][discountable]` | **Boolean**<br>Whether line is discountable
`data[attributes][taxable]` | **Boolean**<br>Whether line is taxable
`data[attributes][line_type]` | **String**<br>One of `section`, `deposit_charge`, `proration`, `charge`, `refund`, `legacy_migration`
`data[attributes][tax_category_id]` | **Uuid**<br>The associated Tax category
`data[attributes][owner_id]` | **Uuid**<br>ID of its owner
`data[attributes][owner_type]` | **String**<br>One of `orders`, `documents`, `carts`


### Includes

This request accepts the following includes:

`owner`


`tax_category`


`planning` => 
`item` => 
`photo`










## Updating a line

Change information, pricing, or increase the quantity of a line. Note that when updating the quantity of a line associated with a planning, the quantity of the planninig will also be updated, which may result in a shortage error.

Order totals are automatically re-calculated after updating a line and an invoice sync will be triggered if changes are relevant.


> How to update a line:

```shell
  curl --request PUT \
    --url 'https://example.booqable.com/api/boomerang/lines/897cf67b-8707-4787-adf8-310cc37f748e' \
    --header 'content-type: application/json' \
    --data '{
      "data": {
        "id": "897cf67b-8707-4787-adf8-310cc37f748e",
        "type": "lines",
        "attributes": {
          "price_each_in_cents": 1000
        }
      }
    }'
```

> A 200 status response looks like this:

```json
  {
  "data": {
    "id": "897cf67b-8707-4787-adf8-310cc37f748e",
    "type": "lines",
    "attributes": {
      "created_at": "2022-03-24T12:37:11+00:00",
      "updated_at": "2022-03-24T12:37:11+00:00",
      "archived": false,
      "archived_at": null,
      "title": "Macbook Pro",
      "extra_information": "Comes with a mouse",
      "quantity": 1,
      "original_price_each_in_cents": 72500,
      "price_each_in_cents": 1000,
      "price_in_cents": 1000,
      "position": 1,
      "charge_label": "29 days",
      "charge_length": 2505600,
      "price_rule_values": null,
      "discountable": true,
      "taxable": true,
      "line_type": "charge",
      "relevant": true,
      "item_id": "9c5c893a-cb76-499f-a4c4-b99916219a6f",
      "tax_category_id": "6aa3107b-2922-4db3-9384-23f9dc088a99",
      "planning_id": "5183c1cc-bb5a-49da-8bdb-baf7e5a82599",
      "parent_line_id": null,
      "owner_id": "81686407-fe7d-4f2b-896e-cce62327c4e5",
      "owner_type": "orders"
    },
    "relationships": {
      "item": {
        "meta": {
          "included": false
        }
      },
      "tax_category": {
        "meta": {
          "included": false
        }
      },
      "planning": {
        "meta": {
          "included": false
        }
      },
      "parent_line": {
        "meta": {
          "included": false
        }
      },
      "nested_lines": {
        "meta": {
          "included": false
        }
      },
      "owner": {
        "meta": {
          "included": false
        }
      }
    }
  },
  "meta": {}
}
```

### HTTP Request

`PUT /api/boomerang/lines/{id}`

### Request params

This request accepts the following paramaters:

Name | Description
- | -
`include` | **String**<br>List of comma seperated relationships `?include=item,tax_category,planning`
`fields[]` | **Array**<br>List of comma seperated fields to include `?fields[lines]=id,created_at,updated_at`


### Request body

This request accepts the following body:

Name | Description
- | -
`data[attributes][title]` | **String**<br>Title of the line
`data[attributes][extra_information]` | **String**<br>Extra information about the line
`data[attributes][quantity]` | **Integer**<br>The quantity to calculate with. When updating quantity of a line with an associated planning, the planning also gets updated, which may lead to a shortage error
`data[attributes][price_each_in_cents]` | **Integer**<br>Price of each line
`data[attributes][position]` | **Integer**<br>Which position the line has
`data[attributes][charge_label]` | **String**<br>Charge label
`data[attributes][charge_length]` | **Integer**<br>The charge length in seconds. It can be different than the time planned. Set to null to recalculate pricing based on order period and apply price rules.
`data[attributes][discountable]` | **Boolean**<br>Whether line is discountable
`data[attributes][taxable]` | **Boolean**<br>Whether line is taxable
`data[attributes][line_type]` | **String**<br>One of `section`, `deposit_charge`, `proration`, `charge`, `refund`, `legacy_migration`
`data[attributes][tax_category_id]` | **Uuid**<br>The associated Tax category
`data[attributes][owner_id]` | **Uuid**<br>ID of its owner
`data[attributes][owner_type]` | **String**<br>One of `orders`, `documents`, `carts`


### Includes

This request accepts the following includes:

`owner`


`tax_category`


`planning` => 
`item` => 
`photo`










## Archiving a line



> How to delete a line:

```shell
  curl --request DELETE \
    --url 'https://example.booqable.com/api/boomerang/lines/ae5225a1-19a1-43b3-98f1-79591907e7a2' \
    --header 'content-type: application/json' \
```

> A 200 status response looks like this:

```json
  {
  "meta": {}
}
```

### HTTP Request

`DELETE /api/boomerang/lines/{id}`

### Request params

This request accepts the following paramaters:

Name | Description
- | -
`include` | **String**<br>List of comma seperated relationships `?include=item,tax_category,planning`
`fields[]` | **Array**<br>List of comma seperated fields to include `?fields[lines]=id,created_at,updated_at`


### Includes

This request does not accept any includes